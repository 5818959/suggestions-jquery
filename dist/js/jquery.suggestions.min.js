/**
 * DaData.ru Suggestions jQuery plugin, version 4.9.4
 *
 * DaData.ru Suggestions jQuery plugin is freely distributable under the terms of MIT-style license
 * Built on DevBridge Autocomplete for jQuery (https://github.com/devbridge/jQuery-Autocomplete)
 * For details, see https://github.com/hflabs/suggestions-jquery
 */
!function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){"use strict";function b(b,c){var d=this;d.element=b,d.el=a(b),d.suggestions=[],d.badQueries=[],d.selectedIndex=-1,d.currentValue=d.element.value,d.intervalId=0,d.cachedResponse={},d.currentRequest=null,d.onChangeTimeout=null,d.$wrapper=null,d.options=a.extend({},l,c),d.classes={hint:"suggestions-hint",mobile:"suggestions-mobile",nowrap:"suggestions-nowrap",selected:"suggestions-selected",suggestion:"suggestions-suggestion",subtext:"suggestions-subtext",subtext_inline:"suggestions-subtext suggestions-subtext_inline",subtext_delimiter:"suggestions-subtext-delimiter",removeConstraint:"suggestions-remove"},d.selection=null,d.$viewport=a(window),d.type=null,d.initialize(),d.setOptions(c)}var c={ESC:27,TAB:9,RETURN:13,SPACE:32,UP:38,DOWN:40},d={},e=".suggestions",f="suggestions",g={OK:0,NO_REGION:1,NO_CITY:2,NO_STREET:3,NO_HOUSE:4,NO_FLAT:5,BAD:6,FOREIGN:7},h="\\s\"'~\\*\\.,:\\|\\[\\]\\(\\)\\{\\}<>",i=new RegExp("["+h+"]+","g"),j="\\-\\+\\/\\\\\\?!@#$%^&",k=new RegExp("["+j+"]+","g"),l={autoSelectFirst:!1,serviceUrl:null,onSearchStart:a.noop,onSearchComplete:a.noop,onSearchError:a.noop,onSelect:null,onSelectNothing:null,onInvalidateSelection:null,minChars:1,width:"auto",deferRequestBy:100,params:{},paramName:"query",formatResult:null,delimiter:null,noCache:!1,containerClass:"suggestions-suggestions",tabDisabled:!1,triggerSelectOnSpace:!0,preventBadQueries:!1,hint:"Выберите вариант или продолжите ввод",type:null,count:5,$helpers:null,headers:null,scrollOnFocus:!0,mobileWidth:980},m={chains:{},on:function(a,b){return this.get(a).push(b),this},get:function(a){var b=this.chains;return b[a]||(b[a]=[])}},n=function(){var b=0;return{escapeRegExChars:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},escapeHtml:function(b){var c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"};return b&&a.each(c,function(a,c){b=b.replace(new RegExp(a,"g"),c)}),b},getDefaultType:function(){return a.support.cors?"POST":"GET"},getDefaultContentType:function(){return a.support.cors?"application/json":"application/x-www-form-urlencoded"},fixURLProtocol:function(b){return a.support.cors?b:b.replace(/^https?:/,location.protocol)},addUrlParams:function(b,c){return b+(/\?/.test(b)?"&":"?")+a.param(c)},serialize:function(b){return a.support.cors?JSON.stringify(b):a.param(b,!0)},compact:function(b){return a.grep(b,function(a){return!!a})},delay:function(a,b){return setTimeout(a,b||0)},uniqueId:function(a){return(a||"")+ ++b},slice:function(a,b){return Array.prototype.slice.call(a,b)},arrayMinus:function(b,c){return c?a.grep(b,function(b){return-1===a.inArray(b,c)}):b},getWords:function(a,b){a=a.replace(/(\d+)([а-яА-ЯёЁ]{2,})/g,"$1 $2").replace(/([а-яА-ЯёЁ]+)(\d+)/g,"$1 $2");var c=this.compact(a.split(/[.,\s"\(\)]+/g)),d=c.pop(),e=this.arrayMinus(c,b);return e.push(d),e},normalize:function(a,b){var c=this;return c.getWords(a,b).join(" ")},stringEncloses:function(a,b){return a.length>b.length&&-1!==a.indexOf(b)},fieldsNotEmpty:function(b,c){if(!a.isPlainObject(b))return!1;var d=!0;return a.each(c,function(a,c){return d=!!b[c]}),d},getDeepValue:function(a,b){var c=b.split("."),d=c.shift();return a&&(c.length?n.getDeepValue(a[d],c.join(".")):a[d])}}}(),o=function(){function b(b){if(0===b.length)return!1;if(1===b.length)return!0;var c=b[0].value,d=a.grep(b,function(a){return 0===a.value.indexOf(c)},!0);return 0===d.length}return{matchByNormalizedQuery:function(b,c){var d=b.toLowerCase(),e=this.STOPWORDS,f=n.normalize(d,e),g=[];return a.each(c,function(a,b){var c=b.value.toLowerCase();return n.stringEncloses(d,c)?!1:c.indexOf(f)>0?!1:void(f===n.normalize(c,e)&&g.push(a))}),1==g.length?g[0]:-1},matchByWords:function(c,d){var e=this.STOPWORDS,f=c.toLowerCase(),g=n.getWords(f,e),h=-1;return b(d)&&a.each(d,function(a,b){var c=b.value.toLowerCase();if(n.stringEncloses(f,c))return!1;var d=n.getWords(c,e);return 0===n.arrayMinus(g,d).length?(h=a,!1):void 0}),h},matchByFields:function(b,c){var d=this.STOPWORDS,e=this.fieldsStopwords,f=n.getWords(b.toLowerCase(),d),g=[];return a.each(c,function(b,c){var d=[];e&&a.each(e,function(a,b){var e=n.getDeepValue(c.data,a),f=e&&n.getWords(e.toLowerCase(),b);f&&f.length&&(d=d.concat(f))}),0===n.arrayMinus(f,d).length&&g.push(b)}),1==g.length?g[0]:-1}}}();!function(){function b(a){var b={LEGAL:/(\d{2})(\d{2})(\d{5})(\d+)/,INDIVIDUAL:/(\d{2})(\d{2})(\d{6})(\d+)/}[a.type],c=a.inn&&b&&b.exec(a.inn);return c&&c.slice(1)}var c=["ао","аобл","дом","респ","а/я","аал","автодорога","аллея","арбан","аул","б-р","берег","бугор","вал","вл","волость","въезд","высел","г","городок","гск","д","двлд","днп","дор","дп","ж/д_будка","ж/д_казарм","ж/д_оп","ж/д_платф","ж/д_пост","ж/д_рзд","ж/д_ст","жилзона","жилрайон","жт","заезд","заимка","зона","к","казарма","канал","кв","кв-л","км","кольцо","комн","кордон","коса","кп","край","линия","лпх","м","массив","местность","мкр","мост","н/п","наб","нп","обл","округ","остров","оф","п","п/о","п/р","п/ст","парк","пгт","пер","переезд","пл","пл-ка","платф","погост","полустанок","починок","пр-кт","проезд","промзона","просек","просека","проселок","проток","протока","проулок","р-н","рзд","россия","рп","ряды","с","с/а","с/мо","с/о","с/п","с/с","сад","сквер","сл","снт","спуск","ст","ст-ца","стр","тер","тракт","туп","у","ул","уч-к","ф/х","ферма","х","ш","бульвар","владение","выселки","гаражно-строительный","город","деревня","домовладение","дорога","квартал","километр","комната","корпус","литер","леспромхоз","местечко","микрорайон","набережная","область","переулок","платформа","площадка","площадь","поселение","поселок","проспект","разъезд","район","республика","село","сельсовет","слобода","сооружение","станица","станция","строение","территория","тупик","улица","улус","участок","хутор","шоссе"];d.NAME={matchers:[o.matchByNormalizedQuery,o.matchByWords],isDataComplete:function(b){var c=this,d=c.options.params,e=a.map(d&&d.parts||["surname","name","patronymic"],function(a){return a.toLowerCase()});return n.fieldsNotEmpty(b,e)},composeValue:function(a){return n.compact([a.surname,a.name,a.patronymic]).join(" ")},urlSuffix:"fio"},d.ADDRESS={STOPWORDS:c,matchers:[o.matchByNormalizedQuery,o.matchByWords],geoEnabled:!0,boundsAvailable:["region","area","city","settlement","street","house","block","flat"],isDataComplete:function(a){var b=[this.bounds.to||"house"];return!(!n.fieldsNotEmpty(a,b)||"qc_complete"in a&&a.qc_complete===g.NO_FLAT)},composeValue:function(a){return n.compact([a.region_with_type||n.compact([a.region,a.region_type]).join(" "),a.area_with_type||n.compact([a.area_type,a.area]).join(" "),a.city_with_type||n.compact([a.city_type,a.city]).join(" "),a.settlement_with_type||n.compact([a.settlement_type,a.settlement]).join(" "),a.street_with_type||n.compact([a.street_type,a.street]).join(" "),n.compact([a.house_type,a.house,a.block_type,a.block]).join(" "),n.compact([a.flat_type,a.flat]).join(" "),a.postal_box?"а/я "+a.postal_box:null]).join(", ")},urlSuffix:"address"},d.PARTY={fieldsStopwords:{"address.value":c,inn:null,ogrn:null,"name.full":null,"name.short":null,"name.latin":null,"opf.full":null,"opf.short":null},matchers:[o.matchByFields],isDataComplete:function(){return!0},enrichServiceName:"default",urlSuffix:"party",formatResult:function(a,d,e,f){var g=this,i=e.data&&b(e.data),j=n.getDeepValue(e,"data.address.value");return g.isMobile&&((f||(f={})).maxLength=50),a=g.formatResult.call(g,a,d,e,f),j&&(j=j.replace(/^\d{6}( РОССИЯ)?, /i,""),j=g.isMobile?j.replace(new RegExp("^([^"+h+"]+["+h+"]+[^"+h+"]+).*"),"$1"):g.formatResult(j,d,e,{unformattableTokens:c})),(i||j)&&(a+='<div class="'+g.classes.subtext+'"><span class="'+g.classes.subtext_inline+'">'+(i&&i.join('<span class="'+g.classes.subtext_delimiter+'"></span>')||"")+"</span>"+(j||"")+"</div>"),a}}}();var p={suggest:{defaultParams:{type:n.getDefaultType(),dataType:"json",contentType:n.getDefaultContentType()},addTypeInUrl:!0},detectAddressByIp:{defaultParams:{type:"GET",dataType:"json"},addTypeInUrl:!1}};b.utils=n,b.defaultOptions=l,b.version="4.9.4",a.Suggestions=b,b.prototype={initialize:function(){var a=this;a.element.setAttribute("autocomplete","off"),this.el.addClass("suggestions-input").css("box-sizing","border-box"),a.uniqueId=n.uniqueId("i"),a.createWrapper(),a.notify("initialize"),a.bindWindowEvents(),a.fixPosition()},dispose:function(){var a=this;a.notify("dispose"),a.el.removeData(f).removeClass("suggestions-input"),a.unbindWindowEvents(),a.removeWrapper(),a.el.trigger("suggestions-dispose")},notify:function(b){var c=this,d=n.slice(arguments,1);return a.map(m.get(b),function(a){return a.apply(c,d)})},createWrapper:function(){var b=this;b.$wrapper=a('<div class="suggestions-wrapper"/>'),b.el.after(b.$wrapper),b.$wrapper.add(b.options.$helpers).on("mousedown"+e,a.proxy(b.onMousedown,b))},removeWrapper:function(){var b=this;b.$wrapper.remove(),a(b.options.$helpers).off(e)},onMousedown:function(b){var c=this;b.preventDefault(),c.cancelBlur=!0,n.delay(function(){delete c.cancelBlur}),a(b.target).closest(".ui-menu-item").length||n.delay(function(){a(document).one("mousedown",function(b){var d=c.el.add(c.$wrapper).add(c.options.$helpers);d=d.filter(function(){return this===b.target||a.contains(this,b.target)}),d.length||c.hide()})})},bindWindowEvents:function(){var b=this;b.$viewport.on("resize"+e+b.uniqueId,a.proxy(b.fixPosition,b))},unbindWindowEvents:function(){this.$viewport.off("resize"+e+this.uniqueId)},scrollToTop:function(){var b=this,c=b.options.scrollOnFocus;c===!0&&(c=b.el),c instanceof a&&c.length>0&&a("body,html").animate({scrollTop:c.offset().top},"fast")},setOptions:function(b){var c=this;if(a.extend(c.options,b),c.type=d[c.options.type],!c.type)throw c.disable(),"`type` option is incorrect! Must be one of: "+a.map(d,function(a,b){return'"'+b+'"'}).join(", ");c.notify("setOptions")},fixPosition:function(){var b,c,d=this,e={};d.isMobile=d.$viewport.width()<=d.options.mobileWidth,d.notify("resetPosition"),d.el.css("paddingLeft",""),d.el.css("paddingRight",""),e.paddingLeft=parseFloat(d.el.css("paddingLeft")),e.paddingRight=parseFloat(d.el.css("paddingRight")),a.extend(e,d.el.offset()),e.borderTop="none"==d.el.css("border-top-style")?0:parseFloat(d.el.css("border-top-width")),e.borderLeft="none"==d.el.css("border-left-style")?0:parseFloat(d.el.css("border-left-width")),e.innerHeight=d.el.innerHeight(),e.innerWidth=d.el.innerWidth(),e.outerHeight=d.el.outerHeight(),e.componentsLeft=0,e.componentsRight=0,b=d.$wrapper.offset(),c={top:e.top-b.top,left:e.left-b.left},d.notify("fixPosition",c,e),e.componentsLeft&&d.el.css("paddingLeft",e.componentsLeft+"px"),e.componentsRight&&d.el.css("paddingRight",e.componentsRight+"px")},clearCache:function(){this.cachedResponse={},this.badQueries=[]},clear:function(){var a=this;a.clearCache(),a.currentValue="",a.selection=null,a.hide(),a.suggestions=[],a.el.val(""),a.el.trigger("suggestions-clear"),a.notify("clear")},disable:function(){var a=this;a.disabled=!0,a.abortRequest(),a.hide()},enable:function(){this.disabled=!1},update:function(){var a=this,b=a.el.val(),c=a.getQuery(b);c.length>=a.options.minChars?a.updateSuggestions(c):a.hide()},setSuggestion:function(b){var c,d=this;a.isPlainObject(b)&&(c=b.value||"",d.currentValue=c,d.el.val(c),d.selection=b,d.suggestions=[b],d.abortRequest())},getAjaxParams:function(c,d){var e=this,f=a.trim(e.options.token),g=e.options.serviceUrl,h=p[c],i=a.extend({},h.defaultParams),j={};return/\/$/.test(g)||(g+="/"),g+=c,h.addTypeInUrl&&(g+="/"+e.type.urlSuffix),g=n.fixURLProtocol(g),a.support.cors?(f&&(j.Authorization="Token "+f),j["X-Version"]=b.version,i.headers||(i.headers={}),a.extend(i.headers,e.options.headers,j)):(f&&(j.token=f),j.version=b.version,g=n.addUrlParams(g,j)),i.url=g,a.extend(i,d)},getQuery:function(b){var c,d=this.options.delimiter;return d?(c=b.split(d),a.trim(c[c.length-1])):b},constructRequestParams:function(b,c){var d=this,e=d.options,f=a.isFunction(e.params)?e.params.call(d.element,b):a.extend({},e.params);return a.each(d.notify("requestParams"),function(b,c){a.extend(f,c)}),f[e.paramName]=b,a.isNumeric(e.count)&&e.count>0&&(f.count=e.count),a.extend(f,c)},updateSuggestions:function(a){var b=this;b.getSuggestions(a).done(function(c){b.assignSuggestions(c,a)})},getSuggestions:function(b,c,d){var e,f=this,g=f.options,h=g.serviceUrl,i=f.constructRequestParams(b,c),j=h+"?"+a.param(i||{}),k=a.Deferred(),l=d&&d.noCallbacks;return e=f.cachedResponse[j],e&&a.isArray(e.suggestions)?k.resolve(e.suggestions):f.isBadQuery(b)?k.reject():l||g.onSearchStart.call(f.element,i)!==!1?f.doGetSuggestions(i).done(function(a){f.processResponse(a,b,j)?k.resolve(a.suggestions):k.reject(),l||g.onSearchComplete.call(f.element,b,a.suggestions)}).fail(function(a,c,d){k.reject(),l||g.onSearchError.call(f.element,b,a,c,d)}):k.reject(),k},doGetSuggestions:function(b){var c=this,d=a.ajax(c.getAjaxParams("suggest",{data:n.serialize(b)}));return c.abortRequest(),c.currentRequest=d,c.notify("request"),d.always(function(){c.currentRequest=null,c.notify("request")}),d},isBadQuery:function(b){if(!this.options.preventBadQueries)return!1;var c=!1;return a.each(this.badQueries,function(a,d){return!(c=0===b.indexOf(d))}),c},abortRequest:function(){var a=this;a.currentRequest&&a.currentRequest.abort()},processResponse:function(b,c,d){var e=this,f=e.options;return b&&a.isArray(b.suggestions)?(e.verifySuggestionsFormat(b.suggestions),e.setUnrestrictedValues(b.suggestions),f.noCache||(e.cachedResponse[d]=b,f.preventBadQueries&&0===b.suggestions.length&&e.badQueries.push(c)),c!==e.getQuery(e.currentValue)?!1:!0):!1},verifySuggestionsFormat:function(b){"string"==typeof b[0]&&a.each(b,function(a,c){b[a]={value:c,data:null}})},assignSuggestions:function(a,b){var c=this;c.suggestions=a,c.notify("assignSuggestions",b)},getValue:function(a){var b,c,d=this,e=d.options.delimiter;return e?(b=d.currentValue,c=b.split(e),1===c.length?a:b.substr(0,b.length-c[c.length-1].length)+a):a},shouldRestrictValues:function(){var a=this;return a.options.restrict_value&&a.constraints&&1==Object.keys(a.constraints).length},setUnrestrictedValues:function(b){var c=this,d=c.shouldRestrictValues(),e=c.getFirstConstraintLabel();a.each(b,function(a,b){b.unrestricted_value=d?e+", "+b.value:b.value})},findSuggestionIndex:function(b){var c=this,d=-1;return""!==a.trim(b)&&a.each(c.type.matchers,function(a,e){return d=e.call(c.type,b,c.suggestions),-1===d}),d}},function(){var d={bindElementEvents:function(){var b=this;b.el.on("keydown"+e,a.proxy(b.onElementKeyDown,b)),b.el.on(["keyup"+e,"cut"+e,"paste"+e].join(" "),a.proxy(b.onElementKeyUp,b)),b.el.on("blur"+e,a.proxy(b.onElementBlur,b)),b.el.on("focus"+e,a.proxy(b.onElementFocus,b))},unbindElementEvents:function(){this.el.off(e)},onElementBlur:function(){var a=this;return a.cancelBlur?void delete a.cancelBlur:(a.selectCurrentValue({trim:!0,noSpace:!0}),void a.abortRequest())},onElementFocus:function(){var a=this;a.cancelFocus||n.delay(function(){a.fixPosition(),a.update(),a.isMobile&&(a.setCursorAtEnd(),a.scrollToTop())}),a.cancelFocus=!1},onElementKeyDown:function(a){var b=this;if(!b.disabled)if(b._waitingForTriggerSelectOnSpace=!1,b.visible){switch(a.which){case c.ESC:b.el.val(b.currentValue),b.hide(),b.abortRequest();break;case c.TAB:if(b.options.tabDisabled===!1)return;break;case c.RETURN:b.selectCurrentValue({trim:!0});break;case c.SPACE:if(b.options.triggerSelectOnSpace&&b.isCursorAtEnd()){var d=-1!==b.selectCurrentValue({continueSelecting:!0});b._waitingForTriggerSelectOnSpace=!d,d&&a.preventDefault()}return;case c.UP:b.moveUp();break;case c.DOWN:b.moveDown();break;default:return}a.stopImmediatePropagation(),a.preventDefault()}else switch(a.which){case c.DOWN:b.suggest();break;case c.RETURN:b.triggerOnSelectNothing();break;case c.SPACE:b._waitingForTriggerSelectOnSpace=!0}},onElementKeyUp:function(a){var b=this;if(!b.disabled){switch(a.which){case c.UP:case c.DOWN:return}clearTimeout(b.onChangeTimeout),b.currentValue!==b.el.val()&&(b.options.deferRequestBy>0?b.onChangeTimeout=n.delay(function(){b.onValueChange()},b.options.deferRequestBy):b.onValueChange())}},onValueChange:function(){var a=this,b=a.el.val();a.selection&&(a.trigger("InvalidateSelection",a.selection),a.selection=null),clearTimeout(a.onChangeTimeout),a.currentValue=b,a.selectedIndex=-1,a.update(),a.notify("valueChange")},isCursorAtEnd:function(){var a,b=this,c=b.el.val().length,d=b.element.selectionStart;return"number"==typeof d?d===c:document.selection?(a=document.selection.createRange(),a.moveStart("character",-c),c===a.text.length):!0},setCursorAtEnd:function(){var a=this.element;a.selectionEnd=a.selectionStart=a.value.length,a.scrollLeft=a.scrollWidth}};a.extend(b.prototype,d),m.on("initialize",d.bindElementEvents).on("dispose",d.unbindElementEvents)}(),function(){var c={},d={checkToken:function(){function b(){d.checkToken()}var d=this,e=a.trim(d.options.token),f=c[e];if(e)if(f&&a.isFunction(f.promise))switch(f.state()){case"resolved":d.enable();break;case"rejected":d.disable();break;default:f.always(b)}else(c[e]=a.ajax(d.getAjaxParams("suggest"))).always(b)}};b.resetTokens=function(){c={}},a.extend(b.prototype,d),m.on("setOptions",d.checkToken)}(),function(){function c(){d=null,b.defaultOptions.geoLocation=e}if("GET"!=n.getDefaultType()){var d,e=!0,f={checkLocation:function(){var b=this;b.type.geoEnabled&&b.options.geoLocation&&(b.geoLocation=a.Deferred(),a.isPlainObject(b.options.geoLocation)?b.geoLocation.resolve(b.options.geoLocation):(d||(d=a.ajax(b.getAjaxParams("detectAddressByIp"))),d.done(function(a){var c=a&&a.location&&a.location.data;c&&c.kladr_id?b.geoLocation.resolve(c):b.geoLocation.reject()}).fail(function(){b.geoLocation.reject()})))},getGeoLocation:function(){return this.geoLocation},constructParams:function(){var b=this,c={};return b.geoLocation&&a.isFunction(b.geoLocation.promise)&&"resolved"==b.geoLocation.state()&&b.geoLocation.done(function(a){c.locations_boost=[a]}),c}};a.extend(l,{geoLocation:e}),a.extend(b,{resetLocation:c}),a.extend(b.prototype,{getGeoLocation:f.getGeoLocation}),m.on("setOptions",f.checkLocation).on("requestParams",f.constructParams)}}(),function(){function b(a){return a&&a.data&&a.data.qc===c.CORRECT}var c={CORRECT:0,INCORRECT:1},e={"default":{enrichSuggestion:function(b){return a.Deferred().resolve(b)}},dadata:function(){return{enrichSuggestion:function(c){var d=this,e=a.Deferred();return c.data&&null!=c.data.qc?e.resolve(c):(d.disableDropdown(),d.currentValue=c.value,d.getSuggestions(c.value,{count:1},{noCallbacks:!0}).always(function(){d.enableDropdown()}).done(function(a){var d=a[0];e.resolve(b(d)?d:c)}).fail(function(){e.resolve(c)}),e)}}}()},f={selectEnrichService:function(){var b=this,c=b.options.type,f=a.trim(b.options.token);b.enrichService=b.options.useDadata&&c&&d[c]&&f?e[d[c].enrichServiceName||"dadata"]:e["default"]}};a.extend(l,{useDadata:!0}),m.on("setOptions",f.selectEnrichService)}(),function(){function c(a){return a.toLowerCase().replace(/[ёЁ]/g,"е")}function d(b){var c=[];return a.each(b,function(a,b){var d=b.split(k);c.push(b),d.length>1&&(c=c.concat(d))}),c}function f(b){return a.map(b,function(a){var b=n.escapeHtml(a.wordOriginal);return b&&a.matched&&(b="<strong>"+b+"</strong>"),a.before&&(b=n.escapeHtml(a.before)+b),a.after&&(b+=n.escapeHtml(a.after)),b}).join("")}function g(b,c){var d=b.split(", ");return 1===d.length?b:a.map(d,function(a){return'<span class="'+c+'">'+a+"</span>"}).join(", ")}var l={createContainer:function(){var b=this,c="."+b.classes.suggestion,d=b.options,f=a("<div/>").addClass(d.containerClass).css({position:"absolute",display:"none"});b.$container=f,b.$wrapper.append(f),"auto"!==d.width&&f.width(d.width),f.on("click"+e,c,a.proxy(b.onSuggestionClick,b))},onSuggestionClick:function(b){var c,d=this,e=a(b.target);if(!d.dropdownDisabled){for(;e.length&&!(c=e.attr("data-index"));)e=e.closest("."+d.classes.suggestion);c&&!isNaN(c)&&d.select(+c)}d.cancelFocus=!0,d.el.focus()},setDropdownPosition:function(a,b){var c=this;c.$container.toggleClass(c.classes.mobile,c.isMobile).css(c.isMobile?{left:a.left-b.left+"px",top:a.top+b.outerHeight+"px",width:c.$viewport.width()+"px"}:{left:a.left+"px",top:a.top+b.borderTop+b.innerHeight+"px",width:("auto"===c.options.width?c.el.outerWidth():c.options.width)+"px"}),c.containerItemsPadding=b.left+b.borderLeft+b.paddingLeft},setItemsPositions:function(){var a=this,b=a.getSuggestionsItems();b.css("paddingLeft",a.isMobile?a.containerItemsPadding+"px":"")},getSuggestionsItems:function(){return this.$container.children("."+this.classes.suggestion)},toggleDropdownEnabling:function(a){this.dropdownDisabled=!a,this.$container.attr("disabled",!a)},disableDropdown:function(){this.toggleDropdownEnabling(!1)},enableDropdown:function(){this.toggleDropdownEnabling(!0)},hasSuggestionsToChoose:function(){var b=this;return b.suggestions.length>1||1===b.suggestions.length&&(!b.selection||a.trim(b.suggestions[0].value)!=a.trim(b.selection.value))},suggest:function(){if(!this.hasSuggestionsToChoose())return void this.hide();var b=this,c=b.options,d=c.formatResult||b.type.formatResult||b.formatResult,e=a.trim(b.getQuery(b.currentValue)),f=c.beforeRender,g=[];!b.isMobile&&c.hint&&b.suggestions.length&&g.push('<div class="'+b.classes.hint+'">'+c.hint+"</div>"),b.selectedIndex=-1,a.each(b.suggestions,function(a,c){c==b.selection&&(b.selectedIndex=a),g.push('<div class="'+b.classes.suggestion+'" data-index="'+a+'">'+d.call(b,c.value,e,c,{unformattableTokens:b.type.STOPWORDS})+"</div>")}),b.$container.html(g.join("")),c.autoSelectFirst&&-1===b.selectedIndex&&(b.selectedIndex=0),-1!==b.selectedIndex&&b.getSuggestionsItems().eq(b.selectedIndex).addClass(b.classes.selected),a.isFunction(f)&&f.call(b.element,b.$container),b.$container.show(),b.visible=!0,b.setItemsPositions()},formatResult:function(b,e,k,l){function m(a,b){var c;a[b]&&(c=a[b].length,t+=c,a[b]=a[b].substr(0,t),t>0&&c>t&&(a[b]+="..."))}var o,p,q=this,r=[],s=l&&l.unformattableTokens,t=l&&l.maxLength||b.length,u=c(e).split(i),v=d([u[u.length-1]]),w=a.map(v,function(a){return new RegExp("^(.*["+j+"]+)?("+n.escapeRegExChars(a)+")(?=[^"+h+"]+)","i")}),x=new RegExp("([^"+h+"]*)(["+h+"]*)","g");for(u=d(u);(o=x.exec(b))&&o[0];)p=o[1]&&c(o[1]),r.push(p?{before:null,wordFormatted:p,wordOriginal:o[1],matched:-1===a.inArray(p,s)&&a.inArray(p,u)>=0,after:o[2],length:o[0].length}:{after:o[0]});a.each(r,function(b,c){return!c.matched&&c.wordFormatted&&-1===a.inArray(c.wordFormatted,s)&&a.each(w,function(a,b){var d,e=b.exec(c.wordFormatted);return e&&e[2]?(d=null==e[1]?0:e[1].length,c.matched=!0,c.before=c.wordOriginal.substr(0,d),c.after=c.wordOriginal.substr(d+e[2].length)+c.after,c.wordOriginal=c.wordOriginal.substr(d,e[2].length),!1):void 0}),t-=c.length,0>t?(m(c,"after"),m(c,"wordOriginal"),m(c,"before"),r.length=b+1,!1):void 0});var y=f(r);return g(y,q.classes.nowrap)},hide:function(){var a=this;a.visible=!1,a.selectedIndex=-1,a.$container.hide().empty()},activate:function(a){var b,c,d=this,e=d.classes.selected;return!d.dropdownDisabled&&(c=d.getSuggestionsItems(),c.removeClass(e),d.selectedIndex=a,-1!==d.selectedIndex&&c.length>d.selectedIndex)?(b=c.eq(d.selectedIndex),b.addClass(e),b):null},deactivate:function(a){var b=this;b.dropdownDisabled||(b.selectedIndex=-1,b.getSuggestionsItems().removeClass(b.classes.selected),a&&b.el.val(b.currentValue))},moveUp:function(){var a=this;if(!a.dropdownDisabled)return-1===a.selectedIndex?void(a.suggestions.length&&a.adjustScroll(a.suggestions.length-1)):0===a.selectedIndex?void a.deactivate(!0):void a.adjustScroll(a.selectedIndex-1)},moveDown:function(){var a=this;if(!a.dropdownDisabled)return a.selectedIndex===a.suggestions.length-1?void a.deactivate(!0):void a.adjustScroll(a.selectedIndex+1)},adjustScroll:function(a){var b,c,d,e=this,f=e.activate(a),g=e.$container.scrollTop();f&&f.length&&(b=f.position().top,0>b?e.$container.scrollTop(g+b):(c=b+f.outerHeight(),d=e.$container.innerHeight(),c>d&&e.$container.scrollTop(g-d+c)),e.el.val(e.getValue(e.suggestions[a].value)))}};a.extend(b.prototype,l),m.on("initialize",l.createContainer).on("fixPosition",l.setDropdownPosition).on("fixPosition",l.setItemsPositions).on("assignSuggestions",l.suggest)}(),function(){var b="addon",c=50,d=1e3,e={addon:null},f={NONE:"none",SPINNER:"spinner",CLEAR:"clear"},g=function(b){var c=this,d=a('<span class="suggestions-addon"/>');c.owner=b,c.$el=d,c.type=f.NONE,c.visible=!1,c.initialPadding=null,d.on("click",a.proxy(c,"onClick"))};g.prototype={checkType:function(){var b=this,c=b.owner.options.addon,d=!1;a.each(f,function(a,b){return d=b==c,d?!1:void 0}),d||(c=b.owner.isMobile?f.CLEAR:f.SPINNER),c!=b.type&&(b.type=c,b.$el.attr("data-addon-type",c),b.toggle(!0))},toggle:function(a){var b,c=this;switch(c.type){case f.CLEAR:b=!!c.owner.currentValue;break;case f.SPINNER:b=!!c.owner.currentRequest;break;default:b=!1}b!=c.visible&&(c.visible=b,b?c.show(a):c.hide(a))},show:function(a){var b=this,d={opacity:1};a?(b.$el.show().css(d),b.showBackground(!0)):b.$el.stop(!0,!0).delay(c).queue(function(){b.$el.show(),b.showBackground(),b.$el.dequeue()}).animate(d,"fast")},hide:function(a){var b=this,c={opacity:0};a&&b.$el.hide().css(c),b.$el.stop(!0).animate(c,{duration:"fast",complete:function(){b.$el.hide(),b.hideBackground()}})},fixPosition:function(a,b){var c=this,d=b.innerHeight;c.checkType(),c.$el.css({left:a.left+b.borderLeft+b.innerWidth-d+"px",top:a.top+b.borderTop+"px",height:d,width:d}),c.initialPadding=b.paddingRight,c.width=d,c.visible&&(b.componentsRight+=d)},showBackground:function(a){var c=this,d=c.owner.el,e={paddingRight:c.width};c.width>c.initialPadding&&(c.stopBackground(),a?d.css(e):d.animate(e,{duration:"fast",queue:b}).dequeue(b))},hideBackground:function(a){var c=this,e=c.owner.el,f={paddingRight:c.initialPadding};c.width>c.initialPadding&&(c.stopBackground(!0),a?e.css(f):e.delay(d,b).animate(f,{duration:"fast",queue:b}).dequeue(b))},stopBackground:function(a){this.owner.el.stop(b,!0,a)},onClick:function(){var a=this;a.type==f.CLEAR&&a.owner.clear()}};var h={createAddon:function(){var a=this,b=new g(a);a.$wrapper.append(b.$el),a.addon=b},fixAddonPosition:function(a,b){this.addon.fixPosition(a,b)},checkAddonType:function(){this.addon.checkType()},checkAddonVisibility:function(){this.addon.toggle()},stopBackground:function(){this.addon.stopBackground()}};a.extend(l,e),m.on("initialize",h.createAddon).on("setOptions",h.checkAddonType).on("fixPosition",h.fixAddonPosition).on("clear",h.checkAddonVisibility).on("valueChange",h.checkAddonVisibility).on("request",h.checkAddonVisibility).on("resetPosition",h.stopBackground)}(),function(){function c(b){var c={};return a.isPlainObject(b)&&a.each(b,function(a,b){b&&f.indexOf(a)>=0&&(c[a]=b)}),a.isEmptyObject(c)?void 0:c.kladr_id?{kladr_id:c.kladr_id}:c}function d(b,c){var d=!0,e=c.selection;return e&&e.data&&c.bounds?(a.each(c.bounds.all,function(a,c){return d=e.data[c]===b.data[c]}),d):void 0}var e={constraints:null,restrict_value:!1},f=["kladr_id","postal_code","region","area","city","settlement","street"],g={createConstraints:function(){var b=this;b.constraints={},b.$constraints=a('<ul class="suggestions-constraints"/>'),b.$wrapper.append(b.$constraints),b.$constraints.on("click","."+b.classes.removeConstraint,a.proxy(b.onConstraintRemoveClick,b))},setConstraintsPosition:function(a,b){var c=this;c.$constraints.css({left:a.left+b.borderLeft+b.paddingLeft+"px",top:a.top+b.borderTop+Math.round((b.innerHeight-c.$constraints.height())/2)+"px"}),b.componentsLeft+=c.$constraints.outerWidth(!0)},onConstraintRemoveClick:function(b){var c=this,d=a(b.target).closest("li"),e=d.attr("data-constraint-id");delete c.constraints[e],c.update(),d.fadeOut("fast",function(){c.removeConstraint(e)})},setupConstraints:function(){var b,c=this,d=c.options.constraints;return d?void(d instanceof a||"string"==typeof d||"number"==typeof d.nodeType?(b=a(d),b.is(c.constraints)||(c.unbindFromParent(),b.is(c.el)||(c.constraints=b,b.on(["suggestions-select."+c.uniqueId,"suggestions-selectnothing."+c.uniqueId,"suggestions-invalidateselection."+c.uniqueId,"suggestions-clear."+c.uniqueId].join(" "),a.proxy(c.onParentSelectionChanged,c)),b.on("suggestions-dispose."+c.uniqueId,a.proxy(c.onParentDispose,c))))):(c._constraintsUpdating=!0,a.each(c.constraints,a.proxy(c.removeConstraint,c)),a.each(a.makeArray(d),function(a,b){c.addConstraint(b)}),c._constraintsUpdating=!1,c.fixPosition())):void c.unbindFromParent()},formatConstraint:function(b){var d,e=this;return b&&(b.locations||b.restrictions)?(d=a.makeArray(b.locations||b.restrictions),null==b.label&&e.type.composeValue&&(b.label=a.map(d,function(a){return e.type.composeValue(a)}).join(", ")),b.locations=[],a.each(d,function(a,d){var e=c(d);e&&b.locations.push(e)}),b.locations.length?b:null):void 0},addConstraint:function(b){var c,d,e=this;b=e.formatConstraint(b),b&&(d=n.uniqueId("c"),e.constraints[d]=b,b.label&&(c=a("<li/>").append(a("<span/>").text(b.label)).attr("data-constraint-id",d),b.deletable&&c.append(a('<span class="suggestions-remove"/>')),e.$constraints.append(c),e._constraintsUpdating||e.fixPosition()))},removeConstraint:function(a){var b=this;delete b.constraints[a],b.$constraints.children('[data-constraint-id="'+a+'"]').remove(),b._constraintsUpdating||b.fixPosition()},constructConstraintsParams:function(){for(var b,d,e=this,f=[],g=e.constraints,h={};g instanceof a&&(b=g.suggestions())&&!(d=n.getDeepValue(b,"selection.data"));)g=b.constraints;return g instanceof a?(d=c(d),d&&(h.locations=[d],h.restrict_value=!0)):(a.each(g,function(a,b){f=f.concat(b.locations)}),f.length&&(h.locations=f,h.restrict_value=e.options.restrict_value)),h},getFirstConstraintLabel:function(){var b=this,c=a.isPlainObject(b.constraints)&&Object.keys(b.constraints)[0];return c?b.constraints[c].label:""},unbindFromParent:function(){var b=this.constraints;b instanceof a&&b.off("."+this.uniqueId)},onParentSelectionChanged:function(){this.clear()},onParentDispose:function(){this.unbindFromParent()},shareWithParent:function(b){var c,e=this.constraints instanceof a&&this.constraints.suggestions();e&&e.type===this.type&&!d(b,e)&&(e.shareWithParent(b),c=e.copyBoundedData(b.data,e.bounds.own),c=e.type.composeValue(c),c&&e.setSuggestion({value:c,data:e.copyBoundedData(b.data,e.bounds.all)}))}};a.extend(l,e),a.extend(b.prototype,g),"GET"!=n.getDefaultType()&&m.on("initialize",g.createConstraints).on("setOptions",g.setupConstraints).on("fixPosition",g.setConstraintsPosition).on("requestParams",g.constructConstraintsParams).on("dispose",g.unbindFromParent)}(),function(){var c={proceedQuery:function(a){var b=this;a.length>=b.options.minChars?b.updateSuggestions(a):b.hide()},selectCurrentValue:function(b){var c=this,d=c.selectedIndex,e=b&&b.trim;if(-1===d){var f=c.getQuery(c.el.val());e&&(f=a.trim(f)),d=c.findSuggestionIndex(f)}return c.select(d,b),d},select:function(a,b){function c(){f?(d.selectedIndex=-1,d.updateSuggestions(d.currentValue)):d.hide()}var d=this,e=d.suggestions[a],f=b&&b.continueSelecting,g=b&&b.noSpace,h=b&&b.addSpace;return e?void d.enrichService.enrichSuggestion.call(d,e).done(function(a){var b=d.type.isDataComplete.call(d,a.data);b&&(f=!1),d.checkValueBounds(a),d.currentValue=a.value,(!g&&!b||h)&&(d.currentValue+=" "),d.el.val(d.currentValue),d.selection=a,d.trigger("Select",a),c(),d.shareWithParent(a)}):(f||d.selection||d.triggerOnSelectNothing(),void c())},triggerOnSelectNothing:function(){this.trigger("SelectNothing",this.currentValue)},trigger:function(b){var c=this,d=n.slice(arguments,1),e=c.options["on"+b];a.isFunction(e)&&e.apply(c.element,d),c.el.trigger.apply(c.el,["suggestions-"+b.toLowerCase()].concat(d))},trySelectOnSpace:function(b){var c,d=this,e=/\s$/;d.options.triggerSelectOnSpace&&d._waitingForTriggerSelectOnSpace&&e.test(b)&&(c=d.findSuggestionIndex(a.trim(b)),-1!==c&&(d._waitingForTriggerSelectOnSpace=!1,d.select(c,{continueSelecting:!0,addSpace:!0})))}};a.extend(b.prototype,c),m.on("assignSuggestions",c.trySelectOnSpace)
}(),function(){var b={bounds:null},c={setupBounds:function(){this.bounds={from:null,to:null}},setBoundsOptions:function(){var b,c=this,d=c.type.boundsAvailable,e=a.trim(c.options.bounds).split("-"),f=e[0],g=e[e.length-1],h=[],i=[];-1===a.inArray(f,d)&&(f=null),-1===a.inArray(g,d)&&(g=null),(f||g)&&(b=!f,a.each(d,function(a,c){return c==f&&(b=!0),i.push(c),b&&h.push(c),c==g?!1:void 0})),c.bounds.from=f,c.bounds.to=g,c.bounds.all=i,c.bounds.own=h},constructBoundsParams:function(){var a=this,b={};return a.bounds.from&&(b.from_bound={value:a.bounds.from}),a.bounds.to&&(b.to_bound={value:a.bounds.to}),b},checkValueBounds:function(b){var c=this,d=c.copyBoundedData(b.data,c.bounds.own);!a.isEmptyObject(d)&&c.type.composeValue&&(d=c.type.composeValue(d),d&&(b.value=d))},copyBoundedData:function(b,c){var d={};return a.each(c,function(c,e){a.each([e,e+"_type",e+"_type_full",e+"_with_type"],function(a,c){null!=b[c]&&(d[c]=b[c])})}),d}};a.extend(l,b),a.extend(a.Suggestions.prototype,c),m.on("initialize",c.setupBounds).on("setOptions",c.setBoundsOptions).on("requestParams",c.constructBoundsParams)}(),a.fn.suggestions=function(c,d){return 0===arguments.length?this.first().data(f):this.each(function(){var e=a(this),g=e.data(f);"string"==typeof c?g&&"function"==typeof g[c]&&g[c](d):(g&&g.dispose&&g.dispose(),g=new b(this,c),e.data(f,g))})}});